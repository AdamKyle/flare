document.addEventListener("alpine:init",()=>{Alpine.data("tableWrapper",(i,s)=>({childElementOpen:!1,filtersOpen:i.entangle("filterSlideDownDefaultVisible"),paginationCurrentCount:i.entangle("paginationCurrentCount"),paginationTotalItemCount:i.entangle("paginationTotalItemCount"),paginationCurrentItems:i.entangle("paginationCurrentItems"),selectedItems:i.entangle("selected"),alwaysShowBulkActions:!i.entangle("hideBulkActionsWhenEmpty"),toggleSelectAll(){s&&(this.paginationTotalItemCount===this.selectedItems.length?this.clearSelected():this.setAllSelected())},setAllSelected(){s&&i.setAllSelected()},clearSelected(){s&&i.clearSelected()},selectAllOnPage(){if(!s)return;let r=this.selectedItems,e=this.paginationCurrentItems.values();for(let l of e)r.push(l.toString());this.selectedItems=[...new Set(r)]}})),Alpine.data("numberRangeFilter",(i,s,r,e,l)=>({allFilters:i.entangle("filterComponents",!1),originalMin:0,originalMax:100,filterMin:0,filterMax:100,currentMin:0,currentMax:100,hasUpdate:!1,wireValues:i.entangle("filterComponents."+s,!1),defaultMin:e.minRange,defaultMax:e.maxRange,restrictUpdates:!1,updateStyles(){let t=document.getElementById(r),a=document.getElementById(l+"-min"),o=document.getElementById(l+"-max");t.style.setProperty("--value-a",a.value),t.style.setProperty("--text-value-a",JSON.stringify(a.value)),t.style.setProperty("--value-b",o.value),t.style.setProperty("--text-value-b",JSON.stringify(o.value))},setupWire(){this.wireValues!==void 0?(this.filterMin=this.originalMin=this.wireValues.min!==void 0?this.wireValues.min:this.defaultMin,this.filterMax=this.originalMax=this.wireValues.max!==void 0?this.wireValues.max:this.defaultMax):(this.filterMin=this.originalMin=this.defaultMin,this.filterMax=this.originalMax=this.defaultMax),this.updateStyles()},allowUpdates(){this.updateWire()},updateWire(){let t=parseInt(this.filterMin),a=parseInt(this.filterMax);(t!=this.originalMin||a!=this.originalMax)&&(a<t&&(this.filterMin=a,this.filterMax=t),this.hasUpdate=!0,this.originalMin=t,this.originalMax=a),this.updateStyles()},updateWireable(){this.hasUpdate&&(this.hasUpdate=!1,this.wireValues={min:this.filterMin,max:this.filterMax},i.set("filterComponents."+s,this.wireValues))},init(){this.setupWire(),this.$watch("allFilters",t=>this.setupWire())}})),Alpine.data("flatpickrFilter",(i,s,r,e,l)=>({wireValues:i.entangle("filterComponents."+s),flatpickrInstance:flatpickr(e,{mode:"range",clickOpens:!0,allowInvalidPreload:!0,defaultDate:[],ariaDateFormat:r.ariaDateFormat,allowInput:r.allowInput,altFormat:r.altFormat,altInput:r.altInput,dateFormat:r.dateFormat,locale:"en",minDate:r.earliestDate,maxDate:r.latestDate,onOpen:function(){window.childElementOpen=!0},onChange:function(t,a,o){if(t.length>1){var d=a.split(" ")[0],h=a.split(" ")[2],n={};window.childElementOpen=!1,window.filterPopoverOpen=!1,n={minDate:d,maxDate:h},i.set("filterComponents."+s,n)}}}),setupWire(){if(this.wireValues!==void 0)if(this.wireValues.minDate!==void 0&&this.wireValues.maxDate!==void 0){let t=[this.wireValues.minDate,this.wireValues.maxDate];this.flatpickrInstance.setDate(t)}else this.flatpickrInstance.setDate([]);else this.flatpickrInstance.setDate([])},init(){this.setupWire(),this.$watch("wireValues",t=>this.setupWire())}})),Alpine.data("reorderFunction",(i,s,r)=>({dragging:!1,reorderEnabled:!1,sourceID:"",targetID:"",evenRowClasses:"",oddRowClasses:"",currentlyHighlightedElement:"",evenRowClassArray:{},oddRowClassArray:{},evenNotInOdd:{},oddNotInEven:{},orderedRows:[],defaultReorderColumn:i.get("defaultReorderColumn"),reorderStatus:i.get("reorderStatus"),currentlyReorderingStatus:i.entangle("currentlyReorderingStatus"),hideReorderColumnUnlessReorderingStatus:i.entangle("hideReorderColumnUnlessReorderingStatus"),reorderDisplayColumn:i.entangle("reorderDisplayColumn"),dragStart(e){this.sourceID=e.target.id,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",e.target.id),e.target.classList.add("laravel-livewire-tables-dragging")},dragOverEvent(e){typeof this.currentlyHighlightedElement=="object"&&this.currentlyHighlightedElement.classList.remove("laravel-livewire-tables-highlight-bottom","laravel-livewire-tables-highlight-top");let l=e.target.closest("tr");this.currentlyHighlightedElement=l,e.offsetY<l.getBoundingClientRect().height/2?(l.classList.add("laravel-livewire-tables-highlight-top"),l.classList.remove("laravel-livewire-tables-highlight-bottom")):(l.classList.remove("laravel-livewire-tables-highlight-top"),l.classList.add("laravel-livewire-tables-highlight-bottom"))},dragLeaveEvent(e){e.target.closest("tr").classList.remove("laravel-livewire-tables-highlight-bottom","laravel-livewire-tables-highlight-top")},dropEvent(e){typeof this.currentlyHighlightedElement=="object"&&this.currentlyHighlightedElement.classList.remove("laravel-livewire-tables-highlight-bottom","laravel-livewire-tables-highlight-top");let l=e.target.closest("tr"),t=e.target.closest("tr").parentNode,a=document.getElementById(this.sourceID).closest("tr");a.classList.remove("laravel-livewire-table-dragging"),a.rowIndex,l.rowIndex;let o=document.getElementById(s);e.offsetY>l.getBoundingClientRect().height/2?t.insertBefore(a,l.nextSibling):t.insertBefore(a,l);let d="even";for(let h=1,n;n=o.rows[h];h++)n.classList.contains("hidden")||n.classList.contains("md:hidden")||(d==="even"?(n.classList.remove(...this.oddNotInEven),n.classList.add(...this.evenNotInOdd),d="odd"):(n.classList.remove(...this.evenNotInOdd),n.classList.add(...this.oddNotInEven),d="even"))},reorderToggle(){this.currentlyReorderingStatus?i.disableReordering():(this.hideReorderColumnUnlessReorderingStatus&&(this.reorderDisplayColumn=!0),i.enableReordering())},cancelReorder(){this.hideReorderColumnUnlessReorderingStatus&&(this.reorderDisplayColumn=!1),i.disableReordering()},updateOrderedItems(){let e=document.getElementById(s),l=[];for(let t=1,a;a=e.rows[t];t++)l.push({[r]:a.getAttribute("rowpk"),[this.defaultReorderColumn]:t});i.storeReorder(l)},setupEvenOddClasses(){if(this.currentlyReorderingStatus===!0){let e=document.getElementById(s).getElementsByTagName("tbody")[0],l=[],t=[];e.rows[0]!==void 0&&e.rows[1]!==void 0&&(l=Array.from(e.rows[0].classList),t=Array.from(e.rows[1].classList),this.evenNotInOdd=l.filter(a=>!t.includes(a)),this.oddNotInEven=t.filter(a=>!l.includes(a)),l=[],t=[])}},init(){this.$watch("currentlyReorderingStatus",e=>this.setupEvenOddClasses())}}))});
